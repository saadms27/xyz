import{Q as Oe}from"./QCircularProgress.2ad60061.js";import{x as je,r as V,c as l,bc as Ue,aE as J,n as Ke,t as Ge,aC as Xe,g as be,al as We,h as b,D as Je,aG as Ze,k as et,aD as tt,w as at,X as lt,_ as rt,d as st,G as Q,P as Z,H as ee,j as s,K as u,bf as nt,L as g,R as y,O as B,M as ot,aa as ut,Q as te}from"./index.7b556ff3.js";import{b as F,h as I,Q as P,d as D}from"./auth.7706eac0.js";import{Q as E}from"./QItemLabel.98a18efd.js";import{Q as it}from"./QDate.edc299d4.js";import{Q as ct}from"./QTime.30a15111.js";import{Q as ae}from"./QField.efaf4fb8.js";import{Q as dt}from"./QBadge.23b350d6.js";import{T as vt}from"./TouchPan.d4ad0205.js";import{Q as mt}from"./QSpace.db01d5c0.js";import{Q as ft}from"./QForm.d31b2145.js";import{r as bt}from"./rewatch_requests.30c3df7e.js";import"./axios.a02fe868.js";import"./vue-i18n.d5518d49.js";import"./index.8e8f3c06.js";import"./_commonjsHelpers.4e997714.js";import"./use-render-cache.1a7235d4.js";import"./touch.3df10340.js";import"./selection.91c5c328.js";const fe="q-slider__marker-labels",pt=a=>({value:a}),ht=({marker:a})=>b("div",{key:a.value,style:a.style,class:a.classes},a.label),pe=[34,37,40,33,39,38],kt={...Ge,...Xe,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:a=>a>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,hideSelection:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},gt=["pan","update:modelValue","change"];function Ct({updateValue:a,updatePosition:i,getDragging:q,formAttrs:o}){const{props:e,emit:Y,slots:d,proxy:{$q:v}}=be(),C=je(e,v),T=Ze(o),h=V(!1),S=V(!1),k=V(!1),M=V(!1),p=l(()=>e.vertical===!0?"--v":"--h"),O=l(()=>"-"+(e.switchLabelSide===!0?"switched":"standard")),$=l(()=>e.vertical===!0?e.reverse===!0:e.reverse!==(v.lang.rtl===!0)),w=l(()=>isNaN(e.innerMin)===!0||e.innerMin<e.min?e.min:e.innerMin),_=l(()=>isNaN(e.innerMax)===!0||e.innerMax>e.max?e.max:e.innerMax),m=l(()=>e.disable!==!0&&e.readonly!==!0&&w.value<_.value),x=l(()=>{if(e.step===0)return r=>r;const t=(String(e.step).trim().split(".")[1]||"").length;return r=>parseFloat(r.toFixed(t))}),L=l(()=>e.step===0?1:e.step),he=l(()=>m.value===!0?e.tabindex||0:-1),N=l(()=>e.max-e.min),le=l(()=>_.value-w.value),A=l(()=>U(w.value)),j=l(()=>U(_.value)),z=l(()=>e.vertical===!0?$.value===!0?"bottom":"top":$.value===!0?"right":"left"),re=l(()=>e.vertical===!0?"height":"width"),ke=l(()=>e.vertical===!0?"width":"height"),se=l(()=>e.vertical===!0?"vertical":"horizontal"),ge=l(()=>{const t={role:"slider","aria-valuemin":w.value,"aria-valuemax":_.value,"aria-orientation":se.value,"data-step":e.step};return e.disable===!0?t["aria-disabled"]="true":e.readonly===!0&&(t["aria-readonly"]="true"),t}),Ce=l(()=>`q-slider q-slider${p.value} q-slider--${h.value===!0?"":"in"}active inline no-wrap `+(e.vertical===!0?"row":"column")+(e.disable===!0?" disabled":" q-slider--enabled"+(m.value===!0?" q-slider--editable":""))+(k.value==="both"?" q-slider--focus":"")+(e.label||e.labelAlways===!0?" q-slider--label":"")+(e.labelAlways===!0?" q-slider--label-always":"")+(C.value===!0?" q-slider--dark":"")+(e.dense===!0?" q-slider--dense q-slider--dense"+p.value:""));function H(t){const r="q-slider__"+t;return`${r} ${r}${p.value} ${r}${p.value}${O.value}`}function ne(t){const r="q-slider__"+t;return`${r} ${r}${p.value}`}const ye=l(()=>{const t=e.selectionColor||e.color;return"q-slider__selection absolute"+(t!==void 0?` text-${t}`:"")}),qe=l(()=>ne("markers")+" absolute overflow-hidden"),Se=l(()=>ne("track-container")),Me=l(()=>H("pin")),we=l(()=>H("label")),$e=l(()=>H("text-container")),_e=l(()=>H("marker-labels-container")+(e.markerLabelsClass!==void 0?` ${e.markerLabelsClass}`:"")),xe=l(()=>"q-slider__track relative-position no-outline"+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),Re=l(()=>{const t={[ke.value]:e.trackSize};return e.trackImg!==void 0&&(t.backgroundImage=`url(${e.trackImg}) !important`),t}),De=l(()=>"q-slider__inner absolute"+(e.innerTrackColor!==void 0?` bg-${e.innerTrackColor}`:"")),oe=l(()=>{const t=j.value-A.value,r={[z.value]:`${100*A.value}%`,[re.value]:t===0?"2px":`${100*t}%`};return e.innerTrackImg!==void 0&&(r.backgroundImage=`url(${e.innerTrackImg}) !important`),r});function Le(t){const{min:r,max:n,step:c}=e;let f=r+t*(n-r);if(c>0){const R=(f-w.value)%c;f+=(Math.abs(R)>=c/2?(R<0?-1:1)*c:0)-R}return f=x.value(f),F(f,w.value,_.value)}function U(t){return N.value===0?0:(t-e.min)/N.value}function Be(t,r){const n=We(t),c=e.vertical===!0?F((n.top-r.top)/r.height,0,1):F((n.left-r.left)/r.width,0,1);return F($.value===!0?1-c:c,A.value,j.value)}const ue=l(()=>Ue(e.markers)===!0?e.markers:L.value),ie=l(()=>{const t=[],r=ue.value,n=e.max;let c=e.min;do t.push(c),c+=r;while(c<n);return t.push(n),t}),ce=l(()=>{const t=` ${fe}${p.value}-`;return fe+`${t}${e.switchMarkerLabelsSide===!0?"switched":"standard"}${t}${$.value===!0?"rtl":"ltr"}`}),K=l(()=>e.markerLabels===!1?null:Ye(e.markerLabels).map((t,r)=>({index:r,value:t.value,label:t.label||t.value,classes:ce.value+(t.classes!==void 0?" "+t.classes:""),style:{...ve(t.value),...t.style||{}}}))),de=l(()=>({markerList:K.value,markerMap:Te.value,classes:ce.value,getStyle:ve})),Ve=l(()=>{const t=le.value===0?"2px":100*ue.value/le.value;return{...oe.value,backgroundSize:e.vertical===!0?`2px ${t}%`:`${t}% 2px`}});function Ye(t){if(t===!1)return null;if(t===!0)return ie.value.map(pt);if(typeof t=="function")return ie.value.map(n=>{const c=t(n);return J(c)===!0?{...c,value:n}:{value:n,label:c}});const r=({value:n})=>n>=e.min&&n<=e.max;return Array.isArray(t)===!0?t.map(n=>J(n)===!0?n:{value:n}).filter(r):Object.keys(t).map(n=>{const c=t[n],f=Number(n);return J(c)===!0?{...c,value:f}:{value:f,label:c}}).filter(r)}function ve(t){return{[z.value]:`${100*(t-e.min)/N.value}%`}}const Te=l(()=>{if(e.markerLabels===!1)return null;const t={};return K.value.forEach(r=>{t[r.value]=r}),t});function Qe(){if(d["marker-label-group"]!==void 0)return d["marker-label-group"](de.value);const t=d["marker-label"]||ht;return K.value.map(r=>t({marker:r,...de.value}))}const Ie=l(()=>[[vt,Fe,void 0,{[se.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function Fe(t){t.isFinal===!0?(M.value!==void 0&&(i(t.evt),t.touch===!0&&a(!0),M.value=void 0,Y("pan","end")),h.value=!1,k.value=!1):t.isFirst===!0?(M.value=q(t.evt),i(t.evt),a(),h.value=!0,Y("pan","start")):(i(t.evt),a())}function me(){k.value=!1}function Ne(t){i(t,q(t)),a(),S.value=!0,h.value=!0,document.addEventListener("mouseup",G,!0)}function G(){S.value=!1,h.value=!1,a(!0),me(),document.removeEventListener("mouseup",G,!0)}function Ae(t){i(t,q(t)),a(!0)}function ze(t){pe.includes(t.keyCode)&&a(!0)}function He(t){if(e.vertical===!0)return null;const r=v.lang.rtl!==e.reverse?1-t:t;return{transform:`translateX(calc(${2*r-1} * ${e.thumbSize} / 2 + ${50-100*r}%))`}}function Pe(t){const r=l(()=>S.value===!1&&(k.value===t.focusValue||k.value==="both")?" q-slider--focus":""),n=l(()=>`q-slider__thumb q-slider__thumb${p.value} q-slider__thumb${p.value}-${$.value===!0?"rtl":"ltr"} absolute non-selectable`+r.value+(t.thumbColor.value!==void 0?` text-${t.thumbColor.value}`:"")),c=l(()=>({width:e.thumbSize,height:e.thumbSize,[z.value]:`${100*t.ratio.value}%`,zIndex:k.value===t.focusValue?2:void 0})),f=l(()=>t.labelColor.value!==void 0?` text-${t.labelColor.value}`:""),R=l(()=>He(t.ratio.value)),X=l(()=>"q-slider__text"+(t.labelTextColor.value!==void 0?` text-${t.labelTextColor.value}`:""));return()=>{const W=[b("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[b("path",{d:e.thumbPath})]),b("div",{class:"q-slider__focus-ring fit"})];return(e.label===!0||e.labelAlways===!0)&&(W.push(b("div",{class:Me.value+" absolute fit no-pointer-events"+f.value},[b("div",{class:we.value,style:{minWidth:e.thumbSize}},[b("div",{class:$e.value,style:R.value},[b("span",{class:X.value},t.label.value)])])])),e.name!==void 0&&e.disable!==!0&&T(W,"push")),b("div",{class:n.value,style:c.value,...t.getNodeData()},W)}}function Ee(t,r,n,c){const f=[];e.innerTrackColor!=="transparent"&&f.push(b("div",{key:"inner",class:De.value,style:oe.value})),e.selectionColor!=="transparent"&&f.push(b("div",{key:"selection",class:ye.value,style:t.value})),e.markers!==!1&&f.push(b("div",{key:"marker",class:qe.value,style:Ve.value})),c(f);const R=[Je("div",{key:"trackC",class:Se.value,tabindex:r.value,...n.value},[b("div",{class:xe.value,style:Re.value},f)],"slide",m.value,()=>Ie.value)];if(e.markerLabels!==!1){const X=e.switchMarkerLabelsSide===!0?"unshift":"push";R[X](b("div",{key:"markerL",class:_e.value},Qe()))}return R}return Ke(()=>{document.removeEventListener("mouseup",G,!0)}),{state:{active:h,focus:k,preventFocus:S,dragging:M,editable:m,classes:Ce,tabindex:he,attributes:ge,roundValueFn:x,keyStep:L,trackLen:N,innerMin:w,innerMinRatio:A,innerMax:_,innerMaxRatio:j,positionProp:z,sizeProp:re,isReversed:$},methods:{onActivate:Ne,onMobileClick:Ae,onBlur:me,onKeyup:ze,getContent:Ee,getThumbRenderFn:Pe,convertRatioToModel:Le,convertModelToRatio:U,getDraggingRatio:Be}}}const yt=()=>({});var qt=et({name:"QSlider",props:{...kt,modelValue:{required:!0,default:null,validator:a=>typeof a=="number"||a===null},labelValue:[String,Number]},emits:gt,setup(a,{emit:i}){const{proxy:{$q:q}}=be(),{state:o,methods:e}=Ct({updateValue:p,updatePosition:$,getDragging:O,formAttrs:tt(a)}),Y=V(null),d=V(0),v=V(0);function C(){v.value=a.modelValue===null?o.innerMin.value:F(a.modelValue,o.innerMin.value,o.innerMax.value)}at(()=>`${a.modelValue}|${o.innerMin.value}|${o.innerMax.value}`,C),C();const T=l(()=>e.convertModelToRatio(v.value)),h=l(()=>o.active.value===!0?d.value:T.value),S=l(()=>{const m={[o.positionProp.value]:`${100*o.innerMinRatio.value}%`,[o.sizeProp.value]:`${100*(h.value-o.innerMinRatio.value)}%`};return a.selectionImg!==void 0&&(m.backgroundImage=`url(${a.selectionImg}) !important`),m}),k=e.getThumbRenderFn({focusValue:!0,getNodeData:yt,ratio:h,label:l(()=>a.labelValue!==void 0?a.labelValue:v.value),thumbColor:l(()=>a.thumbColor||a.color),labelColor:l(()=>a.labelColor),labelTextColor:l(()=>a.labelTextColor)}),M=l(()=>o.editable.value!==!0?{}:q.platform.is.mobile===!0?{onClick:e.onMobileClick}:{onMousedown:e.onActivate,onFocus:w,onBlur:e.onBlur,onKeydown:_,onKeyup:e.onKeyup});function p(m){v.value!==a.modelValue&&i("update:modelValue",v.value),m===!0&&i("change",v.value)}function O(){return Y.value.getBoundingClientRect()}function $(m,x=o.dragging.value){const L=e.getDraggingRatio(m,x);v.value=e.convertRatioToModel(L),d.value=a.snap!==!0||a.step===0?L:e.convertModelToRatio(v.value)}function w(){o.focus.value=!0}function _(m){if(!pe.includes(m.keyCode))return;lt(m);const x=([34,33].includes(m.keyCode)?10:1)*o.keyStep.value,L=([34,37,40].includes(m.keyCode)?-1:1)*(o.isReversed.value===!0?-1:1)*(a.vertical===!0?-1:1)*x;v.value=F(o.roundValueFn.value(v.value+L),o.innerMin.value,o.innerMax.value),p()}return()=>{const m=e.getContent(S,o.tabindex,M,x=>{x.push(k())});return b("div",{ref:Y,class:o.classes.value+(a.modelValue===null?" q-slider--no-value":""),...o.attributes.value,"aria-valuenow":a.modelValue},m)}}});const St=st({name:"rewatch-request-edit",computed:{request(){return this.rewatchRequestsS.one}},methods:{async approve(){var a=I(this.date.value,"DD/MM/YYYY HH:mm").utc(),i=I(I().format("DD/MM/YYYY HH:mm"),"DD/MM/YYYY HH:mm").utc();if(a.isBefore(i)){console.log(a),console.log(i),this.date.error="You can't select a date before now";return}this.request!=null&&(await this.rewatchRequestsS.update(this.request,{duration:this.duration.value,status:"approved"}),this.rewatchRequestsS.getAll(),this.rewatchRequestsS.getOne(this.request.id))},async deny(){this.request!=null&&(await this.rewatchRequestsS.update(this.request,{status:"denied"}),this.rewatchRequestsS.getAll(),this.rewatchRequestsS.getOne(this.request.id))}},data(){return{rewatchRequestsS:bt(),date:{error:"",value:I().toISOString()},duration:{error:"",value:10}}},async mounted(){var a,i,q;await this.rewatchRequestsS.getOne(parseInt(this.$route.params.id)),((a=this.request)==null?void 0:a.date)!=null?this.date.value=I(new Date(this.request.date)).format("DD/MM/YYYY HH:mm"):this.date.value=I().format("DD/MM/YYYY HH:mm"),this.duration.value=(q=(i=this.request)==null?void 0:i.duration)!=null?q:10}}),Mt={class:"q-pa-md"},wt={key:1},$t=y("h5",{class:"q-ma-md q-pt-md"},"Edit Rewatch Request",-1),_t=["href"],xt=["href"],Rt=["href"],Dt=y("b",null,"Scheduled Date",-1),Lt=y("br",null,null,-1),Bt=y("br",null,null,-1),Vt={class:"q-pa-md"},Yt=y("b",null,"Duration in hours",-1),Tt={class:"q-pa-md full-width"},Qt={class:"row"};function It(a,i,q,o,e,Y){return Q(),Z("div",Mt,[a.rewatchRequestsS.working||a.request==null||a.request.lesson==null?(Q(),ee(Oe,{key:0,indeterminate:"",size:"50px",color:"primary",class:"q-ma-md fixed-center","z-index":"1000"})):(Q(),Z("div",wt,[s(ft,null,{default:u(()=>[$t,s(nt),s(P,null,{default:u(()=>[s(D,{avatar:"",class:"text-bold"},{default:u(()=>[g("Lesson:")]),_:1}),s(D,null,{default:u(()=>[s(E,{class:"text-primary text-bold"},{default:u(()=>{var d,v,C,T,h,S,k,M,p;return[y("a",{href:"/#/courseSections/"+((C=(v=(d=a.request)==null?void 0:d.lesson)==null?void 0:v.course_section)==null?void 0:C.id)+"/lessons/"+a.request.lesson.id},B(a.request.lesson.title),9,_t),g(" /"+B((S=(h=(T=a.request)==null?void 0:T.lesson)==null?void 0:h.course_section)==null?void 0:S.title)+"/ ",1),((p=(M=(k=a.request)==null?void 0:k.lesson)==null?void 0:M.course_section)==null?void 0:p.course)!=null?(Q(),Z("a",{key:0,href:"/#/courses/"+a.request.lesson.course_section.course.id},B(a.request.lesson.course_section.course.name),9,xt)):ot("",!0)]}),_:1})]),_:1})]),_:1}),s(P,null,{default:u(()=>[s(D,{avatar:"",class:"text-bold"},{default:u(()=>[g("Student:")]),_:1}),s(D,null,{default:u(()=>[s(E,{class:"text-primary text-bold"},{default:u(()=>{var d,v,C;return[y("a",{href:"/#/students/"+((d=a.request.student)==null?void 0:d.id)},B((C=(v=a.request.student)==null?void 0:v.user)==null?void 0:C.username),9,Rt)]}),_:1})]),_:1})]),_:1}),s(P,null,{default:u(()=>[s(D,{avatar:"",class:"text-bold"},{default:u(()=>[g("created at:")]),_:1}),s(D,null,{default:u(()=>[s(E,{class:"text-primary text-bold"},{default:u(()=>[g(B(a.request.created),1)]),_:1})]),_:1})]),_:1}),s(P,null,{default:u(()=>[s(D,{avatar:"",class:"text-bold"},{default:u(()=>[g("status:")]),_:1}),s(D,null,{default:u(()=>[s(E,{class:"text-primary text-bold"},{default:u(()=>[g(B(a.request.status),1)]),_:1})]),_:1})]),_:1}),Dt,Lt,Bt,s(ae,{class:"no-outline",borderless:"",error:a.date.error.length>0,"error-message":a.date.error},{default:u(()=>[s(it,{modelValue:a.date.value,"onUpdate:modelValue":i[0]||(i[0]=d=>a.date.value=d),mask:"DD/MM/YYYY HH:mm",minimal:""},null,8,["modelValue"]),s(ct,{modelValue:a.date.value,"onUpdate:modelValue":i[1]||(i[1]=d=>a.date.value=d),mask:"DD/MM/YYYY HH:mm",minimal:""},null,8,["modelValue"])]),_:1},8,["error","error-message"]),y("div",Vt,[s(ae,null,{default:u(()=>[s(ut,{filled:"",modelValue:a.date.value,"onUpdate:modelValue":i[2]||(i[2]=d=>a.date.value=d)},null,8,["modelValue"])]),_:1})]),Yt,s(ae,{class:"no-outline",borderless:"",error:a.duration.error.length>0,"error-message":a.duration.error},{default:u(()=>[y("div",Tt,[s(dt,{ckass:"q-mb-lg",color:"primary"},{default:u(()=>[g(B(a.duration.value)+" hours",1)]),_:1}),s(qt,{class:"full-width",type:"number",min:1,max:6,color:"text-primary","label-always":"",modelValue:a.duration.value,"onUpdate:modelValue":i[3]||(i[3]=d=>a.duration.value=d),placeholder:"Duration"},null,8,["modelValue"])])]),_:1},8,["error","error-message"]),y("div",Qt,[s(mt),s(te,{color:"red",onClick:a.deny,style:{margin:"0 10px"}},{default:u(()=>[g("Deny")]),_:1},8,["onClick"]),a.request.status=="approved"?(Q(),ee(te,{key:0,color:"blue",onClick:a.approve},{default:u(()=>[g("Update Schedule")]),_:1},8,["onClick"])):(Q(),ee(te,{key:1,color:"green",onClick:a.approve,style:{margin:"0 10px"}},{default:u(()=>[g("Approve")]),_:1},8,["onClick"]))])]),_:1})]))])}var la=rt(St,[["render",It]]);export{la as default};
